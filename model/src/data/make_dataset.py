"""Module to retrieve data from various sources and create the raw data file(s).

This module includes functions to extract data from APIs or other sources and 
save them into multiple raw data files. The files will be saved in the `data/raw/` 
directory under subdirectories for each BRT system.

A non-BRT-specific subdirectory will also be populated for BRT ridership statistics
taken from the National Transit Database.

This module utilises the BRTData and NTDData classes and their respective functions
(defined in transit_data.py).
"""

import os
from transit_data import BRTData, NTDData

def save_brt_data(brt_data: BRTData):
    print('Data retrieval starting for:', brt_data.name)

    brt_data.save_income()
    print('Income CSV created.')

    brt_data.save_pop_age()
    print('Population CSV created.')
    print('Median Age CSV created.')
    
    brt_data.save_household()
    print('Household Type CSV created.')

    brt_data.save_car_ownership()
    print('Car Ownership CSV created.')

    brt_data.save_num_businesses()
    print('Businesses CSV created.')

def main():
    brt_data = {
        'cleveland': ['44112', '44104', '44103', '44106', '44114'],
        'houston': ['77056', '77027', '77024', '77055'],
        'kansas': ['64106', '64108', '64109', '64110', '64111', '64112', '64113', '64131'],
        'richmond': ["23220", "23221", "23223", "23224", "23226"],
        'indianapolis': ["46205", "46208", "46220", "46201", "46203", "46225", "46227"],
        'eugene': ["97401", "97402", "97403", "97404", "97477"],
        'albuquerque': ["87102", "87106", "87108", "87109", "87110", "87111", "87112", "87113", "87114", "87120"],
        'aspen_westcliffe_glenwood_springs': ["81601", "81602", "81611", "81612", "81615", "81621", "81623", "81642", "81652", "81654"],
        'fort_collins': ["80521", "80524", "80525", "80526", "80528"],
        'hartford': ["06002", "06032", "06037", "06051", "06052", "06053", "06067", "06074", "06101", "06103", "06105", "06106", "06108", "06109", "06110", "06112", "06114", "06118", "06119", "06120", "06422"],
        'grand_rapids': ["49301", "49306", "49315", "49316", "49321", "49341", "49345", "49348", "49401", "49404", "49418", "49426", "49428", "49464", "49468", "49503", "49504", "49505", "49506", "49507", "49508", "49509", "49512", "49519", "49525", "49534", "49544", "49546", "49548"],
        'orlando': ["32801", "32802", "32803", "32804", "32805", "32806", "32808", "32809", "32810", "32811", "32812", "32814", "32816", "32817", "32818", "32819", "32822", "32824", "32827", "32829", "32832", "32835", "32839", "32853", "32854", "32855", "32856", "32857", "32858", "32859", "32860", "32861", "32862", "32867", "32868", "32869", "32872", "32877", "32878", "32885", "32886", "32887", "32890", "32891", "32893", "32896", "32897", "32898", "32899"],
        'boston': ["02108", "02109", "02110", "02111", "02113", "02114", "02115", "02116", "02118", "02119", "02120", "02121", "02122", "02124", "02125", "02126", "02127", "02128", "02129", "02130", "02131", "02132", "02134", "02135", "02136", "02151", "02163", "02169", "02170", "02171", "02184", "02186", "02199", "02203", "02210", "02215", "02445", "02446"],
        'los_angeles': ["90004", "90005", "90006", "90007", "90012", "90013", "90014", "90015", "90017", "90018", "90019", "90020", "90021", "90026", "90027", "90028", "90029", "90031", "90032", "90033", "90034", "90035", "90036", "90037", "90038", "90039", "90041", "90042", "90043", "90044", "90045", "90046", "90047", "90048", "90057", "90062", "90063", "90064", "90065", "90066", "90068", "90069", "90071", "90089", "90230", "90291", "90292", "90293", "90401", "90402", "90403", "90404", "90405", "90640", "90650", "90723", "91030", "91040", "91042", "91101", "91103", "91104", "91105", "91106", "91107", "91108", "91201", "91202", "91203", "91204", "91205", "91206", "91207", "91208", "91214", "91331", "91335", "91340", "91342", "91343", "91344", "91345", "91352", "91356", "91364", "91367", "91401", "91402", "91403", "91405", "91406", "91411", "91423", "91436", "91501", "91502", "91504", "91505", "91506", "91601", "91602", "91604", "91605", "91606", "91607"],
    }

    for system in brt_data:
        brt = BRTData(system, brt_data[system])
        save_brt_data(brt)

    ntd = NTDData()
    ntd.save_data()

if __name__ == "__main__":
    main()